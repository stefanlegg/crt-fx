{
  "version": 3,
  "sources": ["../src/effects/bloom.ts", "../src/effects/chromatic.ts", "../src/effects/color-bleed.ts", "../src/effects/curvature.ts", "../src/effects/noise.ts", "../src/effects/phosphor.ts", "../src/effects/scanlines.ts", "../src/effects/vignette.ts", "../src/effects/index.ts", "../src/core/shaders.ts", "../src/core/pipeline.ts", "../src/core/renderer.ts", "../src/export.ts", "../src/presets.ts", "../src/index.ts"],
  "sourcesContent": [
    "import type { Effect } from \"../types.js\";\n\nexport const bloom: Effect = {\n\tname: \"bloom\",\n\n\tdefaultParams: {\n\t\tradius: 4,\n\t\tstrength: 0.3,\n\t\tthreshold: 0.7,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_radius;\nuniform float u_strength;\nuniform float u_threshold;\nuniform vec2 u_resolution;\n\nvoid main() {\n  vec4 original = texture2D(u_texture, v_texCoord);\n  vec2 texelSize = 1.0 / u_resolution;\n\n  // Two-pass gaussian approximation combined in single pass\n  // Sample in a cross/star pattern for efficiency\n  vec3 bloomColor = vec3(0.0);\n  float totalWeight = 0.0;\n\n  // Sample radius in texels\n  float r = u_radius;\n\n  for (int i = -12; i <= 12; i++) {\n    for (int j = -12; j <= 12; j++) {\n      float fi = float(i);\n      float fj = float(j);\n      if (abs(fi) > r || abs(fj) > r) continue;\n\n      // Skip corners for diamond/circular pattern (faster)\n      if (fi * fi + fj * fj > r * r) continue;\n\n      vec2 offset = vec2(fi, fj) * texelSize;\n      vec4 samp = texture2D(u_texture, v_texCoord + offset);\n\n      float brightness = dot(samp.rgb, vec3(0.2126, 0.7152, 0.0722));\n      if (brightness < u_threshold) continue;\n\n      float weight = exp(-0.5 * (fi * fi + fj * fj) / (r * r * 0.25 + 0.001));\n      bloomColor += samp.rgb * weight * (brightness - u_threshold);\n      totalWeight += weight;\n    }\n  }\n\n  if (totalWeight > 0.0) {\n    bloomColor /= totalWeight;\n  }\n\n  // Composite bloom onto original\n  vec3 result = original.rgb + bloomColor * u_strength;\n  gl_FragColor = vec4(result, original.a);\n}\n`,\n\n\tsetUniforms(gl, program, params, _time, resolution) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_radius\"), params.radius ?? 4);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_strength\"), params.strength ?? 0.3);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_threshold\"), params.threshold ?? 0.7);\n\t\tgl.uniform2f(gl.getUniformLocation(program, \"u_resolution\"), resolution[0], resolution[1]);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const chromatic: Effect = {\n\tname: \"chromatic\",\n\n\tdefaultParams: {\n\t\toffset: 2.0,\n\t\tangle: 0,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_offset;\nuniform float u_angle;\nuniform vec2 u_resolution;\n\nvoid main() {\n  // Direction from center to current pixel\n  vec2 center = vec2(0.5);\n  vec2 dir = v_texCoord - center;\n\n  // Offset in pixels, converted to UV space\n  vec2 offsetDir;\n  if (u_angle == 0.0) {\n    offsetDir = normalize(dir + vec2(0.0001));\n  } else {\n    float a = u_angle * 3.14159265 / 180.0;\n    offsetDir = vec2(cos(a), sin(a));\n  }\n\n  vec2 texelSize = 1.0 / u_resolution;\n  vec2 off = offsetDir * u_offset * texelSize;\n\n  // Sample R, G, B at different offsets\n  float r = texture2D(u_texture, v_texCoord + off).r;\n  float g = texture2D(u_texture, v_texCoord).g;\n  float b = texture2D(u_texture, v_texCoord - off).b;\n  float a = texture2D(u_texture, v_texCoord).a;\n\n  gl_FragColor = vec4(r, g, b, a);\n}\n`,\n\n\tsetUniforms(gl, program, params, _time, resolution) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_offset\"), params.offset ?? 2.0);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_angle\"), params.angle ?? 0);\n\t\tgl.uniform2f(gl.getUniformLocation(program, \"u_resolution\"), resolution[0], resolution[1]);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const colorBleed: Effect = {\n\tname: \"colorBleed\",\n\n\tdefaultParams: {\n\t\tamount: 0.003,\n\t\tdirection: 0,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_amount;\nuniform float u_direction;\nuniform vec2 u_resolution;\n\nvoid main() {\n  vec4 center = texture2D(u_texture, v_texCoord);\n  vec2 texelSize = 1.0 / u_resolution;\n\n  // Horizontal color bleeding - sample neighbors and smear color\n  float bleedPixels = u_amount * u_resolution.x;\n\n  // Direction: 0 = horizontal (left-to-right), 1 = vertical\n  vec2 dir;\n  if (u_direction < 0.5) {\n    dir = vec2(1.0, 0.0);\n  } else {\n    dir = vec2(0.0, 1.0);\n  }\n\n  // Accumulate weighted color from neighbors (asymmetric - more from left/above)\n  vec3 bleed = center.rgb;\n  float totalWeight = 1.0;\n\n  // Sample previous pixels (trailing bleed)\n  for (int i = 1; i <= 8; i++) {\n    float fi = float(i);\n    if (fi > bleedPixels * 10.0) break;\n\n    float weight = exp(-fi * 0.5 / (bleedPixels * 3.0 + 0.001));\n    vec2 offset = -dir * fi * texelSize;\n    vec3 samp = texture2D(u_texture, v_texCoord + offset).rgb;\n\n    bleed += samp * weight;\n    totalWeight += weight;\n  }\n\n  bleed /= totalWeight;\n\n  // Mix bleeding with original\n  float mixAmt = clamp(u_amount * 10.0, 0.0, 1.0);\n  vec3 result = mix(center.rgb, bleed, mixAmt);\n\n  gl_FragColor = vec4(result, center.a);\n}\n`,\n\n\tsetUniforms(gl, program, params, _time, resolution) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_amount\"), params.amount ?? 0.003);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_direction\"), params.direction ?? 0);\n\t\tgl.uniform2f(gl.getUniformLocation(program, \"u_resolution\"), resolution[0], resolution[1]);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const curvature: Effect = {\n\tname: \"curvature\",\n\n\tdefaultParams: {\n\t\tamount: 0.02,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_amount;\n\nvec2 barrelDistortion(vec2 uv, float k) {\n  // Convert to centered coordinates (-1 to 1)\n  vec2 centered = uv * 2.0 - 1.0;\n\n  // Apply barrel distortion\n  float r2 = dot(centered, centered);\n  vec2 distorted = centered * (1.0 + k * r2 + k * k * r2 * r2);\n\n  // Convert back to 0-1 range\n  return distorted * 0.5 + 0.5;\n}\n\nvoid main() {\n  vec2 uv = barrelDistortion(v_texCoord, u_amount);\n\n  // Black outside the curved screen area\n  if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n    return;\n  }\n\n  gl_FragColor = texture2D(u_texture, uv);\n}\n`,\n\n\tsetUniforms(gl, program, params) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_amount\"), params.amount ?? 0.02);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const noise: Effect = {\n\tname: \"noise\",\n\n\tdefaultParams: {\n\t\tintensity: 0.05,\n\t\tflickerIntensity: 0.03,\n\t\tspeed: 1.0,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_intensity;\nuniform float u_flickerIntensity;\nuniform float u_speed;\nuniform float u_time;\nuniform vec2 u_resolution;\n\n// Pseudo-random hash\nfloat hash(vec2 p) {\n  vec3 p3 = fract(vec3(p.xyx) * 0.1031);\n  p3 += dot(p3, p3.yzx + 33.33);\n  return fract((p3.x + p3.y) * p3.z);\n}\n\n// Smooth noise\nfloat noise2d(vec2 p) {\n  vec2 i = floor(p);\n  vec2 f = fract(p);\n  f = f * f * (3.0 - 2.0 * f); // smoothstep\n  float a = hash(i);\n  float b = hash(i + vec2(1.0, 0.0));\n  float c = hash(i + vec2(0.0, 1.0));\n  float d = hash(i + vec2(1.0, 1.0));\n  return mix(mix(a, b, f.x), mix(c, d, f.x), f.y);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_texture, v_texCoord);\n\n  // Animated noise grain\n  float time = u_time * u_speed;\n  vec2 noiseCoord = v_texCoord * u_resolution;\n  float n = hash(noiseCoord + vec2(time * 127.1, time * 311.7));\n\n  // Apply noise\n  vec3 grain = vec3(n * 2.0 - 1.0) * u_intensity;\n  color.rgb += grain;\n\n  // Flicker: global brightness variation\n  float flicker = 1.0 + (hash(vec2(floor(time * 15.0), 0.0)) * 2.0 - 1.0) * u_flickerIntensity;\n  color.rgb *= flicker;\n\n  gl_FragColor = vec4(clamp(color.rgb, 0.0, 1.0), color.a);\n}\n`,\n\n\tsetUniforms(gl, program, params, time, resolution) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_intensity\"), params.intensity ?? 0.05);\n\t\tgl.uniform1f(\n\t\t\tgl.getUniformLocation(program, \"u_flickerIntensity\"),\n\t\t\tparams.flickerIntensity ?? 0.03,\n\t\t);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_speed\"), params.speed ?? 1.0);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_time\"), time);\n\t\tgl.uniform2f(gl.getUniformLocation(program, \"u_resolution\"), resolution[0], resolution[1]);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const phosphor: Effect = {\n\tname: \"phosphor\",\n\n\tdefaultParams: {\n\t\tstyle: \"shadow-mask\",\n\t\tscale: 1.0,\n\t\tintensity: 0.5,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform int u_style;\nuniform float u_scale;\nuniform float u_intensity;\nuniform vec2 u_resolution;\n\n// Phosphor style constants\nconst int SHADOW_MASK    = 0;\nconst int APERTURE_GRILLE = 1;\nconst int SLOT_MASK      = 2;\nconst int CROMACLEAR     = 3;\nconst int PVM            = 4;\nconst int ARCADE         = 5;\nconst int VGA            = 6;\nconst int COMPOSITE      = 7;\nconst int MONO_GREEN     = 8;\nconst int MONO_AMBER     = 9;\n\nfloat luminance(vec3 c) {\n  return dot(c, vec3(0.2126, 0.7152, 0.0722));\n}\n\nvec3 shadowMask(vec2 fragCoord, float scale) {\n  float cellW = 3.0 * scale;\n  float cellH = 3.0 * scale;\n  vec2 pos = fragCoord;\n  // Offset every other row\n  float row = floor(pos.y / cellH);\n  if (mod(row, 2.0) > 0.5) {\n    pos.x += cellW * 0.5;\n  }\n  float col = mod(pos.x, cellW);\n  float phase = col / cellW;\n  vec3 mask = vec3(0.2);\n  if (phase < 0.333) {\n    mask.r = 1.0;\n    mask.g = 0.3;\n    mask.b = 0.3;\n  } else if (phase < 0.666) {\n    mask.r = 0.3;\n    mask.g = 1.0;\n    mask.b = 0.3;\n  } else {\n    mask.r = 0.3;\n    mask.g = 0.3;\n    mask.b = 1.0;\n  }\n  // Circular dot shape\n  vec2 cellPos = vec2(mod(pos.x, cellW) / cellW, mod(pos.y, cellH) / cellH);\n  float dist = length(cellPos - 0.5) * 2.0;\n  float dot = smoothstep(1.0, 0.3, dist);\n  return mix(vec3(0.1), mask, dot);\n}\n\nvec3 apertureGrille(vec2 fragCoord, float scale) {\n  float cellW = 3.0 * scale;\n  float col = mod(fragCoord.x, cellW);\n  float phase = col / cellW;\n  vec3 mask = vec3(0.0);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.15, 0.15);\n  } else if (phase < 0.666) {\n    mask = vec3(0.15, 1.0, 0.15);\n  } else {\n    mask = vec3(0.15, 0.15, 1.0);\n  }\n  return mask;\n}\n\nvec3 slotMask(vec2 fragCoord, float scale) {\n  float cellW = 3.0 * scale;\n  float cellH = 4.0 * scale;\n  vec2 pos = fragCoord;\n  float row = floor(pos.y / cellH);\n  if (mod(row, 2.0) > 0.5) {\n    pos.x += cellW * 0.5;\n  }\n  float col = mod(pos.x, cellW);\n  float phase = col / cellW;\n  // Slot shape — rectangular with gap\n  float slotY = mod(pos.y, cellH) / cellH;\n  float slotMask = step(0.15, slotY) * step(slotY, 0.85);\n  vec3 mask = vec3(0.1);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.1, 0.1);\n  } else if (phase < 0.666) {\n    mask = vec3(0.1, 1.0, 0.1);\n  } else {\n    mask = vec3(0.1, 0.1, 1.0);\n  }\n  return mix(vec3(0.1), mask, slotMask);\n}\n\nvec3 cromaclear(vec2 fragCoord, float scale) {\n  float cellW = 3.0 * scale;\n  float cellH = 2.0 * scale;\n  float col = mod(fragCoord.x, cellW);\n  float phase = col / cellW;\n  // Elliptical shape\n  vec2 cellPos = vec2(mod(fragCoord.x, cellW) / cellW, mod(fragCoord.y, cellH) / cellH);\n  float ex = (cellPos.x - 0.5) * 2.0;\n  float ey = (cellPos.y - 0.5) * 1.5;\n  float ellipse = smoothstep(1.0, 0.4, length(vec2(ex, ey)));\n  vec3 mask = vec3(0.1);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.1, 0.1);\n  } else if (phase < 0.666) {\n    mask = vec3(0.1, 1.0, 0.1);\n  } else {\n    mask = vec3(0.1, 0.1, 1.0);\n  }\n  return mix(vec3(0.1), mask, ellipse);\n}\n\nvec3 pvmMask(vec2 fragCoord, float scale) {\n  // Ultra-fine aperture grille\n  float cellW = 2.0 * scale;\n  float col = mod(fragCoord.x, cellW);\n  float phase = col / cellW;\n  vec3 mask = vec3(0.0);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.2, 0.2);\n  } else if (phase < 0.666) {\n    mask = vec3(0.2, 1.0, 0.2);\n  } else {\n    mask = vec3(0.2, 0.2, 1.0);\n  }\n  return mask;\n}\n\nvec3 arcadeMask(vec2 fragCoord, float scale) {\n  // Large coarse dot triads\n  float cellW = 6.0 * scale;\n  float cellH = 6.0 * scale;\n  vec2 pos = fragCoord;\n  float row = floor(pos.y / cellH);\n  if (mod(row, 2.0) > 0.5) {\n    pos.x += cellW * 0.5;\n  }\n  float col = mod(pos.x, cellW);\n  float phase = col / cellW;\n  vec2 cellPos = vec2(mod(pos.x, cellW) / cellW, mod(pos.y, cellH) / cellH);\n  float dist = length(cellPos - 0.5) * 2.0;\n  float dot = smoothstep(1.0, 0.2, dist);\n  vec3 mask = vec3(0.0);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.0, 0.0);\n  } else if (phase < 0.666) {\n    mask = vec3(0.0, 1.0, 0.0);\n  } else {\n    mask = vec3(0.0, 0.0, 1.0);\n  }\n  return mix(vec3(0.02), mask, dot);\n}\n\nvec3 vgaMask(vec2 fragCoord, float scale) {\n  // Medium-pitch shadow mask with sharp edges\n  float cellW = 4.0 * scale;\n  float cellH = 4.0 * scale;\n  vec2 pos = fragCoord;\n  float row = floor(pos.y / cellH);\n  if (mod(row, 2.0) > 0.5) {\n    pos.x += cellW * 0.5;\n  }\n  float col = mod(pos.x, cellW);\n  float phase = col / cellW;\n  // Sharp rectangular subpixels\n  vec2 cellPos = vec2(mod(pos.x, cellW) / cellW, mod(pos.y, cellH) / cellH);\n  float inCell = step(0.1, cellPos.x) * step(cellPos.x, 0.9) * step(0.1, cellPos.y) * step(cellPos.y, 0.9);\n  vec3 mask = vec3(0.05);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.1, 0.1);\n  } else if (phase < 0.666) {\n    mask = vec3(0.1, 1.0, 0.1);\n  } else {\n    mask = vec3(0.1, 0.1, 1.0);\n  }\n  return mix(vec3(0.05), mask, inCell);\n}\n\nvec3 compositeMask(vec2 fragCoord, float scale) {\n  // Soft/blurred shadow mask\n  float cellW = 3.0 * scale;\n  float cellH = 3.0 * scale;\n  vec2 pos = fragCoord;\n  float row = floor(pos.y / cellH);\n  if (mod(row, 2.0) > 0.5) {\n    pos.x += cellW * 0.5;\n  }\n  float col = mod(pos.x, cellW);\n  float phase = col / cellW;\n  vec2 cellPos = vec2(mod(pos.x, cellW) / cellW, mod(pos.y, cellH) / cellH);\n  float dist = length(cellPos - 0.5) * 2.0;\n  // Very soft/blurred dot\n  float dot = smoothstep(1.5, 0.0, dist);\n  vec3 mask = vec3(0.2);\n  if (phase < 0.333) {\n    mask = vec3(1.0, 0.3, 0.3);\n  } else if (phase < 0.666) {\n    mask = vec3(0.3, 1.0, 0.3);\n  } else {\n    mask = vec3(0.3, 0.3, 1.0);\n  }\n  return mix(vec3(0.2), mask, dot);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_texture, v_texCoord);\n  vec2 fragCoord = v_texCoord * u_resolution;\n\n  vec3 mask = vec3(1.0);\n\n  if (u_style == SHADOW_MASK) {\n    mask = shadowMask(fragCoord, u_scale);\n  } else if (u_style == APERTURE_GRILLE) {\n    mask = apertureGrille(fragCoord, u_scale);\n  } else if (u_style == SLOT_MASK) {\n    mask = slotMask(fragCoord, u_scale);\n  } else if (u_style == CROMACLEAR) {\n    mask = cromaclear(fragCoord, u_scale);\n  } else if (u_style == PVM) {\n    mask = pvmMask(fragCoord, u_scale);\n  } else if (u_style == ARCADE) {\n    mask = arcadeMask(fragCoord, u_scale);\n  } else if (u_style == VGA) {\n    mask = vgaMask(fragCoord, u_scale);\n  } else if (u_style == COMPOSITE) {\n    mask = compositeMask(fragCoord, u_scale);\n  } else if (u_style == MONO_GREEN) {\n    // Single green phosphor\n    float lum = luminance(color.rgb);\n    color.rgb = vec3(lum * 0.2, lum, lum * 0.2) * vec3(0.2, 1.0, 0.133);\n    mask = vec3(1.0);\n  } else if (u_style == MONO_AMBER) {\n    // Single amber phosphor\n    float lum = luminance(color.rgb);\n    color.rgb = vec3(lum, lum * 0.69, lum * 0.0) * vec3(1.0, 0.69, 0.0);\n    mask = vec3(1.0);\n  }\n\n  // Blend phosphor mask with intensity\n  vec3 result = color.rgb * mix(vec3(1.0), mask, u_intensity);\n\n  gl_FragColor = vec4(result, color.a);\n}\n`,\n\n\tsetUniforms(gl, program, params, _time, resolution) {\n\t\tconst styleMap: Record<string, number> = {\n\t\t\t\"shadow-mask\": 0,\n\t\t\t\"aperture-grille\": 1,\n\t\t\t\"slot-mask\": 2,\n\t\t\tcromaclear: 3,\n\t\t\tpvm: 4,\n\t\t\tarcade: 5,\n\t\t\tvga: 6,\n\t\t\tcomposite: 7,\n\t\t\t\"mono-green\": 8,\n\t\t\t\"mono-amber\": 9,\n\t\t};\n\t\tconst styleIdx = styleMap[params.style as string] ?? 0;\n\t\tgl.uniform1i(gl.getUniformLocation(program, \"u_style\"), styleIdx);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_scale\"), params.scale ?? 1.0);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_intensity\"), params.intensity ?? 0.5);\n\t\tgl.uniform2f(gl.getUniformLocation(program, \"u_resolution\"), resolution[0], resolution[1]);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const scanlines: Effect = {\n\tname: \"scanlines\",\n\n\tdefaultParams: {\n\t\tintensity: 0.5,\n\t\tcount: 800,\n\t\tsharpness: 0.5,\n\t\tphase: 0,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_intensity;\nuniform float u_count;\nuniform float u_sharpness;\nuniform float u_phase;\nuniform vec2 u_resolution;\n\nvoid main() {\n  vec4 color = texture2D(u_texture, v_texCoord);\n\n  // Scanline pattern: sine wave along Y axis\n  float y = v_texCoord.y * u_count + u_phase;\n  float scanline = sin(y * 3.14159265) * 0.5 + 0.5;\n\n  // Sharpen the sine wave using pow — higher sharpness = harder edges\n  scanline = pow(scanline, mix(0.5, 4.0, u_sharpness));\n\n  // Mix between full color and darkened scanline\n  float mask = 1.0 - u_intensity * (1.0 - scanline);\n\n  gl_FragColor = vec4(color.rgb * mask, color.a);\n}\n`,\n\n\tsetUniforms(gl, program, params, time, resolution) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_intensity\"), params.intensity ?? 0.5);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_count\"), params.count ?? 800);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_sharpness\"), params.sharpness ?? 0.5);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_phase\"), (params.phase ?? 0) + time * 0.5);\n\t\tgl.uniform2f(gl.getUniformLocation(program, \"u_resolution\"), resolution[0], resolution[1]);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\n\nexport const vignette: Effect = {\n\tname: \"vignette\",\n\n\tdefaultParams: {\n\t\tstrength: 0.3,\n\t\tradius: 0.8,\n\t},\n\n\tfragmentShader: `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_strength;\nuniform float u_radius;\n\nvoid main() {\n  vec4 color = texture2D(u_texture, v_texCoord);\n\n  // Distance from center (0,0 at center, ~1.0 at corners)\n  vec2 uv = v_texCoord * 2.0 - 1.0;\n  float dist = length(uv);\n\n  // Smooth vignette falloff\n  float vig = smoothstep(u_radius, u_radius + (1.0 - u_radius) * 1.2, dist);\n  float factor = 1.0 - vig * u_strength;\n\n  gl_FragColor = vec4(color.rgb * factor, color.a);\n}\n`,\n\n\tsetUniforms(gl, program, params) {\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_strength\"), params.strength ?? 0.3);\n\t\tgl.uniform1f(gl.getUniformLocation(program, \"u_radius\"), params.radius ?? 0.8);\n\t},\n};\n",
    "import type { Effect } from \"../types.js\";\nimport { bloom } from \"./bloom.js\";\nimport { chromatic } from \"./chromatic.js\";\nimport { colorBleed } from \"./color-bleed.js\";\nimport { curvature } from \"./curvature.js\";\nimport { noise } from \"./noise.js\";\nimport { phosphor } from \"./phosphor.js\";\nimport { scanlines } from \"./scanlines.js\";\nimport { vignette } from \"./vignette.js\";\n\nexport { scanlines, phosphor, chromatic, bloom, vignette, curvature, noise, colorBleed };\n\n/** All effects in recommended pipeline order */\nexport const allEffects: Effect[] = [\n\tcurvature,\n\tcolorBleed,\n\tchromatic,\n\tphosphor,\n\tscanlines,\n\tnoise,\n\tbloom,\n\tvignette,\n];\n",
    "/** Shared fullscreen quad vertex shader */\nexport const VERTEX_SHADER = `\nattribute vec2 a_position;\nvarying vec2 v_texCoord;\nvoid main() {\n  v_texCoord = a_position * 0.5 + 0.5;\n  gl_Position = vec4(a_position, 0.0, 1.0);\n}\n`;\n\n/** Passthrough fragment shader (just samples the texture) */\nexport const PASSTHROUGH_FRAGMENT = `\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\nvoid main() {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n`;\n\n/** Compile a shader from source */\nexport function compileShader(\n\tgl: WebGLRenderingContext,\n\ttype: number,\n\tsource: string,\n): WebGLShader {\n\tconst shader = gl.createShader(type);\n\tif (!shader) throw new Error(\"Failed to create shader\");\n\tgl.shaderSource(shader, source);\n\tgl.compileShader(shader);\n\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\tconst info = gl.getShaderInfoLog(shader);\n\t\tgl.deleteShader(shader);\n\t\tthrow new Error(`Shader compile error: ${info}\\nSource:\\n${source}`);\n\t}\n\treturn shader;\n}\n\n/** Link a program from vertex + fragment shaders */\nexport function createProgram(\n\tgl: WebGLRenderingContext,\n\tvertexSource: string,\n\tfragmentSource: string,\n): WebGLProgram {\n\tconst vs = compileShader(gl, gl.VERTEX_SHADER, vertexSource);\n\tconst fs = compileShader(gl, gl.FRAGMENT_SHADER, fragmentSource);\n\tconst program = gl.createProgram();\n\tif (!program) throw new Error(\"Failed to create program\");\n\tgl.attachShader(program, vs);\n\tgl.attachShader(program, fs);\n\tgl.linkProgram(program);\n\tif (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n\t\tconst info = gl.getProgramInfoLog(program);\n\t\tgl.deleteProgram(program);\n\t\tthrow new Error(`Program link error: ${info}`);\n\t}\n\t// Shaders can be freed after linking\n\tgl.deleteShader(vs);\n\tgl.deleteShader(fs);\n\treturn program;\n}\n",
    "import type { CompiledPass, Effect, FramebufferInfo, MultiPassEffect } from \"../types.js\";\nimport { VERTEX_SHADER, createProgram } from \"./shaders.js\";\n\nexport class Pipeline {\n\tprivate gl: WebGLRenderingContext;\n\tprivate fbos: FramebufferInfo[] = [];\n\tprivate passes: CompiledPass[] = [];\n\tprivate quadBuffer: WebGLBuffer | null = null;\n\tprivate width = 0;\n\tprivate height = 0;\n\n\tconstructor(gl: WebGLRenderingContext) {\n\t\tthis.gl = gl;\n\t\tthis.setupQuad();\n\t}\n\n\tprivate setupQuad(): void {\n\t\tconst gl = this.gl;\n\t\tthis.quadBuffer = gl.createBuffer();\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\n\t\t// Fullscreen triangle pair\n\t\tgl.bufferData(\n\t\t\tgl.ARRAY_BUFFER,\n\t\t\tnew Float32Array([-1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1]),\n\t\t\tgl.STATIC_DRAW,\n\t\t);\n\t}\n\n\tprivate createFBO(width: number, height: number): FramebufferInfo {\n\t\tconst gl = this.gl;\n\t\tconst texture = gl.createTexture()!;\n\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n\t\tconst framebuffer = gl.createFramebuffer()!;\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\n\t\treturn { framebuffer, texture };\n\t}\n\n\t/** Resize all framebuffers */\n\tresize(width: number, height: number): void {\n\t\tif (this.width === width && this.height === height) return;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.destroyFBOs();\n\t\t// We need at least 2 for ping-pong, plus extras for bloom\n\t\t// Create enough — we'll use up to 4\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tthis.fbos.push(this.createFBO(width, height));\n\t\t}\n\t}\n\n\tprivate destroyFBOs(): void {\n\t\tconst gl = this.gl;\n\t\tfor (const fbo of this.fbos) {\n\t\t\tgl.deleteFramebuffer(fbo.framebuffer);\n\t\t\tgl.deleteTexture(fbo.texture);\n\t\t}\n\t\tthis.fbos = [];\n\t}\n\n\t/** Build shader programs for the current set of effects */\n\tbuildPasses(effects: Effect[]): void {\n\t\tconst gl = this.gl;\n\t\t// Clean old programs\n\t\tfor (const p of this.passes) {\n\t\t\tgl.deleteProgram(p.program);\n\t\t}\n\t\tthis.passes = [];\n\n\t\tfor (const effect of effects) {\n\t\t\tif (isMultiPass(effect)) {\n\t\t\t\tfor (let i = 0; i < effect.passes; i++) {\n\t\t\t\t\tconst frag = effect.getFragmentShader(i);\n\t\t\t\t\tconst program = createProgram(gl, VERTEX_SHADER, frag);\n\t\t\t\t\tthis.passes.push({ program, effect, passIndex: i });\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst program = createProgram(gl, VERTEX_SHADER, effect.fragmentShader);\n\t\t\t\tthis.passes.push({ program, effect, passIndex: 0 });\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Run all passes, reading from sourceTexture, rendering final to canvas */\n\trender(\n\t\tsourceTexture: WebGLTexture,\n\t\tparams: Record<string, Record<string, any>>,\n\t\ttime: number,\n\t): void {\n\t\tconst gl = this.gl;\n\t\tif (this.passes.length === 0 || this.fbos.length < 2) return;\n\n\t\tconst resolution: [number, number] = [this.width, this.height];\n\t\tlet inputTexture = sourceTexture;\n\t\tlet pingPong = 0;\n\n\t\tfor (let i = 0; i < this.passes.length; i++) {\n\t\t\tconst pass = this.passes[i];\n\t\t\tconst isLast = i === this.passes.length - 1;\n\t\t\tconst effectParams = params[pass.effect.name] || pass.effect.defaultParams;\n\n\t\t\tif (isLast) {\n\t\t\t\t// Render to canvas\n\t\t\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\t\t\tgl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\t\t\t} else {\n\t\t\t\t// Render to FBO\n\t\t\t\tconst target = this.fbos[pingPong];\n\t\t\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, target.framebuffer);\n\t\t\t\tgl.viewport(0, 0, this.width, this.height);\n\t\t\t}\n\n\t\t\tgl.useProgram(pass.program);\n\n\t\t\t// Bind input texture\n\t\t\tgl.activeTexture(gl.TEXTURE0);\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, inputTexture);\n\t\t\tconst texLoc = gl.getUniformLocation(pass.program, \"u_texture\");\n\t\t\tgl.uniform1i(texLoc, 0);\n\n\t\t\t// Set effect uniforms\n\t\t\tif (isMultiPass(pass.effect)) {\n\t\t\t\tpass.effect.setPassUniforms(\n\t\t\t\t\tgl,\n\t\t\t\t\tpass.program,\n\t\t\t\t\teffectParams,\n\t\t\t\t\ttime,\n\t\t\t\t\tresolution,\n\t\t\t\t\tpass.passIndex,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tpass.effect.setUniforms(gl, pass.program, effectParams, time, resolution);\n\t\t\t}\n\n\t\t\t// Draw quad\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\n\t\t\tconst posLoc = gl.getAttribLocation(pass.program, \"a_position\");\n\t\t\tgl.enableVertexAttribArray(posLoc);\n\t\t\tgl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);\n\t\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\n\n\t\t\tif (!isLast) {\n\t\t\t\tinputTexture = this.fbos[pingPong].texture;\n\t\t\t\tpingPong = (pingPong + 1) % this.fbos.length;\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Render a passthrough (source directly to canvas) */\n\trenderPassthrough(sourceTexture: WebGLTexture, passthroughProgram: WebGLProgram): void {\n\t\tconst gl = this.gl;\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\tgl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\t\tgl.useProgram(passthroughProgram);\n\t\tgl.activeTexture(gl.TEXTURE0);\n\t\tgl.bindTexture(gl.TEXTURE_2D, sourceTexture);\n\t\tgl.uniform1i(gl.getUniformLocation(passthroughProgram, \"u_texture\"), 0);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\n\t\tconst posLoc = gl.getAttribLocation(passthroughProgram, \"a_position\");\n\t\tgl.enableVertexAttribArray(posLoc);\n\t\tgl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\n\t}\n\n\tdispose(): void {\n\t\tconst gl = this.gl;\n\t\tthis.destroyFBOs();\n\t\tfor (const p of this.passes) {\n\t\t\tgl.deleteProgram(p.program);\n\t\t}\n\t\tthis.passes = [];\n\t\tif (this.quadBuffer) {\n\t\t\tgl.deleteBuffer(this.quadBuffer);\n\t\t\tthis.quadBuffer = null;\n\t\t}\n\t}\n}\n\nfunction isMultiPass(effect: Effect): effect is MultiPassEffect {\n\treturn \"passes\" in effect && typeof (effect as any).passes === \"number\";\n}\n\nexport type { MultiPassEffect };\n",
    "import { allEffects } from \"../effects/index.js\";\nimport type { CRTOptions, Effect, ImageSource } from \"../types.js\";\nimport { Pipeline } from \"./pipeline.js\";\nimport { PASSTHROUGH_FRAGMENT, VERTEX_SHADER, createProgram } from \"./shaders.js\";\n\nexport class Renderer {\n\tpublic canvas: HTMLCanvasElement;\n\tpublic gl: WebGLRenderingContext;\n\tprivate pipeline: Pipeline;\n\tprivate sourceTexture: WebGLTexture | null = null;\n\tprivate passthroughProgram: WebGLProgram;\n\tprivate animFrameId: number | null = null;\n\tprivate startTime = 0;\n\tprivate params: Record<string, Record<string, any>> = {};\n\tprivate activeEffects: Effect[] = [];\n\tprivate imageWidth = 0;\n\tprivate imageHeight = 0;\n\tprivate contextLost = false;\n\tprivate onContextLost: (e: Event) => void;\n\tprivate onContextRestored: (e: Event) => void;\n\tprivate resizeObserver: ResizeObserver | null = null;\n\n\tconstructor(canvas: HTMLCanvasElement, options: CRTOptions = {}) {\n\t\tthis.canvas = canvas;\n\t\tconst gl = canvas.getContext(\"webgl\", {\n\t\t\talpha: false,\n\t\t\tpremultipliedAlpha: false,\n\t\t\tpreserveDrawingBuffer: true,\n\t\t\tantialias: false,\n\t\t});\n\t\tif (!gl) throw new Error(\"WebGL not supported\");\n\t\tthis.gl = gl;\n\n\t\tthis.pipeline = new Pipeline(gl);\n\t\tthis.passthroughProgram = createProgram(gl, VERTEX_SHADER, PASSTHROUGH_FRAGMENT);\n\n\t\t// Apply options\n\t\tthis.setOptions(options);\n\n\t\t// Context loss handling\n\t\tthis.onContextLost = (e: Event) => {\n\t\t\te.preventDefault();\n\t\t\tthis.contextLost = true;\n\t\t\tif (this.animFrameId !== null) {\n\t\t\t\tcancelAnimationFrame(this.animFrameId);\n\t\t\t\tthis.animFrameId = null;\n\t\t\t}\n\t\t};\n\t\tthis.onContextRestored = () => {\n\t\t\tthis.contextLost = false;\n\t\t\tthis.rebuildAll();\n\t\t};\n\t\tcanvas.addEventListener(\"webglcontextlost\", this.onContextLost);\n\t\tcanvas.addEventListener(\"webglcontextrestored\", this.onContextRestored);\n\n\t\t// Observe resize\n\t\tthis.resizeObserver = new ResizeObserver(() => this.handleResize());\n\t\tthis.resizeObserver.observe(canvas);\n\t}\n\n\tprivate handleResize(): void {\n\t\tconst dpr = window.devicePixelRatio || 1;\n\t\tconst rect = this.canvas.getBoundingClientRect();\n\t\tconst w = Math.round(rect.width * dpr);\n\t\tconst h = Math.round(rect.height * dpr);\n\t\tif (this.canvas.width !== w || this.canvas.height !== h) {\n\t\t\tthis.canvas.width = w;\n\t\t\tthis.canvas.height = h;\n\t\t\tif (this.imageWidth > 0) {\n\t\t\t\tthis.pipeline.resize(this.imageWidth, this.imageHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetOptions(options: CRTOptions): void {\n\t\t// Map option keys → effect instances & params\n\t\tconst effectMap: Record<string, Effect> = {};\n\t\tfor (const e of allEffects) {\n\t\t\teffectMap[e.name] = e;\n\t\t}\n\n\t\tthis.params = {};\n\t\tthis.activeEffects = [];\n\n\t\t// Determine which effects are enabled and build params\n\t\tconst effectOrder = [\n\t\t\t\"curvature\",\n\t\t\t\"colorBleed\",\n\t\t\t\"chromatic\",\n\t\t\t\"phosphor\",\n\t\t\t\"scanlines\",\n\t\t\t\"noise\",\n\t\t\t\"bloom\",\n\t\t\t\"vignette\",\n\t\t];\n\n\t\tfor (const name of effectOrder) {\n\t\t\tconst opts = (options as any)[name];\n\t\t\tif (opts === undefined) continue;\n\t\t\tif (opts.enabled === false) continue;\n\n\t\t\tconst effect = effectMap[name];\n\t\t\tif (!effect) continue;\n\n\t\t\tthis.params[name] = { ...effect.defaultParams, ...opts };\n\t\t\tthis.activeEffects.push(effect);\n\t\t}\n\n\t\t// Rebuild pipeline\n\t\tif (!this.contextLost) {\n\t\t\tthis.pipeline.buildPasses(this.activeEffects);\n\t\t}\n\t}\n\n\tupdateParams(options: CRTOptions): void {\n\t\t// Deep merge into existing params\n\t\tfor (const [key, val] of Object.entries(options)) {\n\t\t\tif (val === undefined) continue;\n\t\t\tif (typeof val === \"object\" && val !== null) {\n\t\t\t\tif ((val as any).enabled === false) {\n\t\t\t\t\t// Remove effect\n\t\t\t\t\tdelete this.params[key];\n\t\t\t\t\tthis.activeEffects = this.activeEffects.filter((e) => e.name !== key);\n\t\t\t\t} else if (this.params[key]) {\n\t\t\t\t\t// Merge\n\t\t\t\t\tObject.assign(this.params[key], val);\n\t\t\t\t} else {\n\t\t\t\t\t// Add new effect\n\t\t\t\t\tconst effectMap: Record<string, Effect> = {};\n\t\t\t\t\tfor (const e of allEffects) effectMap[e.name] = e;\n\t\t\t\t\tconst effect = effectMap[key];\n\t\t\t\t\tif (effect) {\n\t\t\t\t\t\tthis.params[key] = { ...effect.defaultParams, ...(val as any) };\n\t\t\t\t\t\tthis.activeEffects.push(effect);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!this.contextLost) {\n\t\t\tthis.pipeline.buildPasses(this.activeEffects);\n\t\t}\n\t}\n\n\tasync loadImage(source: ImageSource): Promise<void> {\n\t\tconst gl = this.gl;\n\t\tlet img: TexImageSource;\n\n\t\tif (typeof source === \"string\") {\n\t\t\timg = await loadImageFromURL(source);\n\t\t} else if (source instanceof File || source instanceof Blob) {\n\t\t\tconst url = URL.createObjectURL(source);\n\t\t\ttry {\n\t\t\t\timg = await loadImageFromURL(url);\n\t\t\t} finally {\n\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t}\n\t\t} else if (source instanceof ImageData) {\n\t\t\t// Convert to canvas\n\t\t\tconst c = document.createElement(\"canvas\");\n\t\t\tc.width = source.width;\n\t\t\tc.height = source.height;\n\t\t\tconst ctx = c.getContext(\"2d\")!;\n\t\t\tctx.putImageData(source, 0, 0);\n\t\t\timg = c;\n\t\t} else {\n\t\t\timg = source as TexImageSource;\n\t\t}\n\n\t\t// Get dimensions\n\t\tif (img instanceof HTMLImageElement) {\n\t\t\tthis.imageWidth = img.naturalWidth;\n\t\t\tthis.imageHeight = img.naturalHeight;\n\t\t} else if (img instanceof HTMLCanvasElement) {\n\t\t\tthis.imageWidth = img.width;\n\t\t\tthis.imageHeight = img.height;\n\t\t} else if (img instanceof ImageBitmap) {\n\t\t\tthis.imageWidth = img.width;\n\t\t\tthis.imageHeight = img.height;\n\t\t} else {\n\t\t\tthis.imageWidth = (img as any).width || this.canvas.width;\n\t\t\tthis.imageHeight = (img as any).height || this.canvas.height;\n\t\t}\n\n\t\t// Upload texture\n\t\tif (this.sourceTexture) {\n\t\t\tgl.deleteTexture(this.sourceTexture);\n\t\t}\n\t\tthis.sourceTexture = gl.createTexture();\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.sourceTexture);\n\t\tgl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\n\t\tthis.pipeline.resize(this.imageWidth, this.imageHeight);\n\t\tthis.renderFrame(0);\n\t}\n\n\tprivate renderFrame(time: number): void {\n\t\tif (this.contextLost || !this.sourceTexture) return;\n\t\tconst gl = this.gl;\n\n\t\tgl.clearColor(0, 0, 0, 1);\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\n\t\tif (this.activeEffects.length === 0) {\n\t\t\tthis.pipeline.renderPassthrough(this.sourceTexture, this.passthroughProgram);\n\t\t} else {\n\t\t\tthis.pipeline.render(this.sourceTexture, this.params, time);\n\t\t}\n\t}\n\n\tstart(): void {\n\t\tif (this.animFrameId !== null) return;\n\t\tthis.startTime = performance.now();\n\t\tconst loop = (now: number) => {\n\t\t\tconst t = (now - this.startTime) / 1000;\n\t\t\tthis.renderFrame(t);\n\t\t\tthis.animFrameId = requestAnimationFrame(loop);\n\t\t};\n\t\tthis.animFrameId = requestAnimationFrame(loop);\n\t}\n\n\tstop(): void {\n\t\tif (this.animFrameId !== null) {\n\t\t\tcancelAnimationFrame(this.animFrameId);\n\t\t\tthis.animFrameId = null;\n\t\t}\n\t}\n\n\t/** Render a single frame (for static export) */\n\trenderOnce(): void {\n\t\tthis.renderFrame(performance.now() / 1000);\n\t}\n\n\tprivate rebuildAll(): void {\n\t\tthis.passthroughProgram = createProgram(this.gl, VERTEX_SHADER, PASSTHROUGH_FRAGMENT);\n\t\tthis.pipeline = new Pipeline(this.gl);\n\t\tif (this.imageWidth > 0) {\n\t\t\tthis.pipeline.resize(this.imageWidth, this.imageHeight);\n\t\t}\n\t\tthis.pipeline.buildPasses(this.activeEffects);\n\t}\n\n\tdispose(): void {\n\t\tthis.stop();\n\t\tthis.canvas.removeEventListener(\"webglcontextlost\", this.onContextLost);\n\t\tthis.canvas.removeEventListener(\"webglcontextrestored\", this.onContextRestored);\n\t\tif (this.resizeObserver) {\n\t\t\tthis.resizeObserver.disconnect();\n\t\t\tthis.resizeObserver = null;\n\t\t}\n\t\tconst gl = this.gl;\n\t\tthis.pipeline.dispose();\n\t\tif (this.sourceTexture) {\n\t\t\tgl.deleteTexture(this.sourceTexture);\n\t\t\tthis.sourceTexture = null;\n\t\t}\n\t\tgl.deleteProgram(this.passthroughProgram);\n\t}\n}\n\nfunction loadImageFromURL(url: string): Promise<HTMLImageElement> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst img = new Image();\n\t\timg.crossOrigin = \"anonymous\";\n\t\timg.onload = () => resolve(img);\n\t\timg.onerror = () => reject(new Error(`Failed to load image: ${url}`));\n\t\timg.src = url;\n\t});\n}\n",
    "/** Export the current canvas state to various formats */\n\nexport function exportDataURL(\n\tcanvas: HTMLCanvasElement,\n\tmimeType = \"image/png\",\n\tquality?: number,\n): string {\n\treturn canvas.toDataURL(mimeType, quality);\n}\n\nexport function exportBlob(\n\tcanvas: HTMLCanvasElement,\n\tmimeType = \"image/png\",\n\tquality?: number,\n): Promise<Blob> {\n\treturn new Promise((resolve, reject) => {\n\t\tcanvas.toBlob(\n\t\t\t(blob) => {\n\t\t\t\tif (blob) resolve(blob);\n\t\t\t\telse reject(new Error(\"Failed to export canvas to blob\"));\n\t\t\t},\n\t\t\tmimeType,\n\t\t\tquality,\n\t\t);\n\t});\n}\n\nexport function exportToCanvas(\n\tsourceCanvas: HTMLCanvasElement,\n\ttargetCanvas?: HTMLCanvasElement,\n): HTMLCanvasElement {\n\tconst target = targetCanvas || document.createElement(\"canvas\");\n\ttarget.width = sourceCanvas.width;\n\ttarget.height = sourceCanvas.height;\n\tconst ctx = target.getContext(\"2d\")!;\n\tctx.drawImage(sourceCanvas, 0, 0);\n\treturn target;\n}\n",
    "import type { CRTOptions } from \"./types.js\";\n\nexport const presets: Record<string, CRTOptions> = {\n\ttrinitron: {\n\t\tphosphor: { style: \"aperture-grille\", scale: 1.0, intensity: 0.4 },\n\t\tscanlines: { intensity: 0.3, count: 800, sharpness: 0.4 },\n\t\tbloom: { radius: 3, strength: 0.2, threshold: 0.8 },\n\t\tchromatic: { offset: 1.0 },\n\t\tvignette: { strength: 0.15, radius: 0.85 },\n\t\tcurvature: { amount: 0.01 },\n\t\tnoise: { intensity: 0.01, flickerIntensity: 0.01 },\n\t},\n\n\tarcade: {\n\t\tphosphor: { style: \"arcade\", scale: 1.5, intensity: 0.7 },\n\t\tscanlines: { intensity: 0.8, count: 600, sharpness: 0.7 },\n\t\tbloom: { radius: 5, strength: 0.4, threshold: 0.6 },\n\t\tchromatic: { offset: 3.0 },\n\t\tvignette: { strength: 0.4, radius: 0.7 },\n\t\tcurvature: { amount: 0.04 },\n\t\tnoise: { intensity: 0.06, flickerIntensity: 0.04 },\n\t},\n\n\tpvm: {\n\t\tphosphor: { style: \"pvm\", scale: 0.8, intensity: 0.3 },\n\t\tscanlines: { intensity: 0.25, count: 1000, sharpness: 0.5 },\n\t\tbloom: { radius: 2, strength: 0.15, threshold: 0.85 },\n\t\tchromatic: { offset: 0.5 },\n\t\tvignette: { strength: 0.1, radius: 0.9 },\n\t\tnoise: { intensity: 0.005, flickerIntensity: 0.005 },\n\t},\n\n\tvhs: {\n\t\tphosphor: { style: \"composite\", scale: 1.2, intensity: 0.4 },\n\t\tscanlines: { intensity: 0.2, count: 500, sharpness: 0.2 },\n\t\tcolorBleed: { amount: 0.01, direction: 0 },\n\t\tchromatic: { offset: 4.0 },\n\t\tnoise: { intensity: 0.12, flickerIntensity: 0.08, speed: 2.0 },\n\t\tvignette: { strength: 0.2, radius: 0.75 },\n\t},\n\n\tterminal: {\n\t\tphosphor: { style: \"mono-green\", scale: 1.0, intensity: 0.8 },\n\t\tscanlines: { intensity: 0.6, count: 900, sharpness: 0.6 },\n\t\tbloom: { radius: 5, strength: 0.5, threshold: 0.5 },\n\t\tcurvature: { amount: 0.03 },\n\t\tvignette: { strength: 0.3, radius: 0.8 },\n\t\tnoise: { intensity: 0.04, flickerIntensity: 0.02 },\n\t},\n\n\tamberTerminal: {\n\t\tphosphor: { style: \"mono-amber\", scale: 1.0, intensity: 0.8 },\n\t\tscanlines: { intensity: 0.6, count: 900, sharpness: 0.6 },\n\t\tbloom: { radius: 5, strength: 0.5, threshold: 0.5 },\n\t\tcurvature: { amount: 0.03 },\n\t\tvignette: { strength: 0.3, radius: 0.8 },\n\t\tnoise: { intensity: 0.04, flickerIntensity: 0.02 },\n\t},\n\n\tconsumer90s: {\n\t\tphosphor: { style: \"slot-mask\", scale: 1.3, intensity: 0.5 },\n\t\tscanlines: { intensity: 0.5, count: 700, sharpness: 0.4 },\n\t\tvignette: { strength: 0.5, radius: 0.65 },\n\t\tcurvature: { amount: 0.03 },\n\t\tnoise: { intensity: 0.04, flickerIntensity: 0.03 },\n\t\tchromatic: { offset: 2.0 },\n\t\tcolorBleed: { amount: 0.003 },\n\t},\n\n\tpcMonitor: {\n\t\tphosphor: { style: \"vga\", scale: 1.0, intensity: 0.35 },\n\t\tscanlines: { intensity: 0.2, count: 1080, sharpness: 0.6 },\n\t\tbloom: { radius: 2, strength: 0.1, threshold: 0.9 },\n\t\tvignette: { strength: 0.1, radius: 0.9 },\n\t\tcurvature: { amount: 0.01 },\n\t\tnoise: { intensity: 0.01, flickerIntensity: 0.005 },\n\t},\n\n\tretrogaming: {\n\t\tphosphor: { style: \"shadow-mask\", scale: 1.2, intensity: 0.5 },\n\t\tscanlines: { intensity: 0.5, count: 480, sharpness: 0.5 },\n\t\tbloom: { radius: 3, strength: 0.25, threshold: 0.7 },\n\t\tchromatic: { offset: 1.5 },\n\t\tvignette: { strength: 0.25, radius: 0.8 },\n\t\tcurvature: { amount: 0.02 },\n\t\tnoise: { intensity: 0.03, flickerIntensity: 0.02 },\n\t},\n\n\tcinematic: {\n\t\tphosphor: { style: \"aperture-grille\", scale: 0.9, intensity: 0.25 },\n\t\tscanlines: { intensity: 0.15, count: 1080, sharpness: 0.3 },\n\t\tbloom: { radius: 6, strength: 0.4, threshold: 0.6 },\n\t\tvignette: { strength: 0.6, radius: 0.6 },\n\t\tcurvature: { amount: 0.005 },\n\t\tchromatic: { offset: 0.8 },\n\t\tnoise: { intensity: 0.015, flickerIntensity: 0.01 },\n\t},\n};\n",
    "import { Renderer } from \"./core/renderer.js\";\nimport { exportBlob, exportDataURL, exportToCanvas } from \"./export.js\";\nimport type { CRTOptions, ImageSource } from \"./types.js\";\n\nexport class CRTEffect {\n\tprivate renderer: Renderer;\n\n\tconstructor(canvas: HTMLCanvasElement, options: CRTOptions = {}) {\n\t\tthis.renderer = new Renderer(canvas, options);\n\t}\n\n\t/** Load an image source to apply effects to */\n\tasync loadImage(source: ImageSource): Promise<void> {\n\t\treturn this.renderer.loadImage(source);\n\t}\n\n\t/** Start the animation loop (for time-based effects like noise/flicker) */\n\tstart(): void {\n\t\tthis.renderer.start();\n\t}\n\n\t/** Stop the animation loop */\n\tstop(): void {\n\t\tthis.renderer.stop();\n\t}\n\n\t/** Render a single frame */\n\trenderOnce(): void {\n\t\tthis.renderer.renderOnce();\n\t}\n\n\t/** Deep-merge update options (add, modify, or disable effects) */\n\tupdate(options: CRTOptions): void {\n\t\tthis.renderer.updateParams(options);\n\t\tthis.renderer.renderOnce();\n\t}\n\n\t/** Replace all options */\n\tsetOptions(options: CRTOptions): void {\n\t\tthis.renderer.setOptions(options);\n\t\tthis.renderer.renderOnce();\n\t}\n\n\t/** Export as Blob */\n\tasync exportBlob(mimeType = \"image/png\", quality?: number): Promise<Blob> {\n\t\tthis.renderer.renderOnce();\n\t\treturn exportBlob(this.renderer.canvas, mimeType, quality);\n\t}\n\n\t/** Export as data URL */\n\texportDataURL(mimeType = \"image/png\", quality?: number): string {\n\t\tthis.renderer.renderOnce();\n\t\treturn exportDataURL(this.renderer.canvas, mimeType, quality);\n\t}\n\n\t/** Copy rendered output to another canvas */\n\texportToCanvas(target?: HTMLCanvasElement): HTMLCanvasElement {\n\t\tthis.renderer.renderOnce();\n\t\treturn exportToCanvas(this.renderer.canvas, target);\n\t}\n\n\t/** Get the underlying canvas element */\n\tget canvas(): HTMLCanvasElement {\n\t\treturn this.renderer.canvas;\n\t}\n\n\t/** Cleanup all WebGL resources */\n\tdispose(): void {\n\t\tthis.renderer.dispose();\n\t}\n}\n\n// Re-export everything\nexport { presets } from \"./presets.js\";\nexport { allEffects } from \"./effects/index.js\";\nexport {\n\tscanlines,\n\tphosphor,\n\tchromatic,\n\tbloom,\n\tvignette,\n\tcurvature,\n\tnoise,\n\tcolorBleed,\n} from \"./effects/index.js\";\nexport { exportBlob, exportDataURL, exportToCanvas } from \"./export.js\";\nexport type {\n\tCRTOptions,\n\tImageSource,\n\tEffect,\n\tMultiPassEffect,\n\tPhosphorStyle,\n\tScanlineParams,\n\tChromaticParams,\n\tBloomParams,\n\tPhosphorParams,\n\tNoiseParams,\n\tVignetteParams,\n\tCurvatureParams,\n\tColorBleedParams,\n} from \"./types.js\";\n"
  ],
  "mappings": ";AAEO,IAAM,QAAgB;AAAA,EAC5B,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,WAAW;AAAA,EACZ;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoDhB,WAAW,CAAC,IAAI,SAAS,QAAQ,OAAO,YAAY;AAAA,IACnD,GAAG,UAAU,GAAG,mBAAmB,SAAS,UAAU,GAAG,OAAO,UAAU,CAAC;AAAA,IAC3E,GAAG,UAAU,GAAG,mBAAmB,SAAS,YAAY,GAAG,OAAO,YAAY,GAAG;AAAA,IACjF,GAAG,UAAU,GAAG,mBAAmB,SAAS,aAAa,GAAG,OAAO,aAAa,GAAG;AAAA,IACnF,GAAG,UAAU,GAAG,mBAAmB,SAAS,cAAc,GAAG,WAAW,IAAI,WAAW,EAAE;AAAA;AAE3F;;;ACnEO,IAAM,YAAoB;AAAA,EAChC,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,QAAQ;AAAA,IACR,OAAO;AAAA,EACR;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmChB,WAAW,CAAC,IAAI,SAAS,QAAQ,OAAO,YAAY;AAAA,IACnD,GAAG,UAAU,GAAG,mBAAmB,SAAS,UAAU,GAAG,OAAO,UAAU,CAAG;AAAA,IAC7E,GAAG,UAAU,GAAG,mBAAmB,SAAS,SAAS,GAAG,OAAO,SAAS,CAAC;AAAA,IACzE,GAAG,UAAU,GAAG,mBAAmB,SAAS,cAAc,GAAG,WAAW,IAAI,WAAW,EAAE;AAAA;AAE3F;;;AChDO,IAAM,aAAqB;AAAA,EACjC,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,QAAQ;AAAA,IACR,WAAW;AAAA,EACZ;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkDhB,WAAW,CAAC,IAAI,SAAS,QAAQ,OAAO,YAAY;AAAA,IACnD,GAAG,UAAU,GAAG,mBAAmB,SAAS,UAAU,GAAG,OAAO,UAAU,KAAK;AAAA,IAC/E,GAAG,UAAU,GAAG,mBAAmB,SAAS,aAAa,GAAG,OAAO,aAAa,CAAC;AAAA,IACjF,GAAG,UAAU,GAAG,mBAAmB,SAAS,cAAc,GAAG,WAAW,IAAI,WAAW,EAAE;AAAA;AAE3F;;;AC/DO,IAAM,YAAoB;AAAA,EAChC,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,QAAQ;AAAA,EACT;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA+BhB,WAAW,CAAC,IAAI,SAAS,QAAQ;AAAA,IAChC,GAAG,UAAU,GAAG,mBAAmB,SAAS,UAAU,GAAG,OAAO,UAAU,IAAI;AAAA;AAEhF;;;ACzCO,IAAM,QAAgB;AAAA,EAC5B,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,WAAW;AAAA,IACX,kBAAkB;AAAA,IAClB,OAAO;AAAA,EACR;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiDhB,WAAW,CAAC,IAAI,SAAS,QAAQ,MAAM,YAAY;AAAA,IAClD,GAAG,UAAU,GAAG,mBAAmB,SAAS,aAAa,GAAG,OAAO,aAAa,IAAI;AAAA,IACpF,GAAG,UACF,GAAG,mBAAmB,SAAS,oBAAoB,GACnD,OAAO,oBAAoB,IAC5B;AAAA,IACA,GAAG,UAAU,GAAG,mBAAmB,SAAS,SAAS,GAAG,OAAO,SAAS,CAAG;AAAA,IAC3E,GAAG,UAAU,GAAG,mBAAmB,SAAS,QAAQ,GAAG,IAAI;AAAA,IAC3D,GAAG,UAAU,GAAG,mBAAmB,SAAS,cAAc,GAAG,WAAW,IAAI,WAAW,EAAE;AAAA;AAE3F;;;ACpEO,IAAM,WAAmB;AAAA,EAC/B,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,OAAO;AAAA,IACP,OAAO;AAAA,IACP,WAAW;AAAA,EACZ;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA0PhB,WAAW,CAAC,IAAI,SAAS,QAAQ,OAAO,YAAY;AAAA,IACnD,MAAM,WAAmC;AAAA,MACxC,eAAe;AAAA,MACf,mBAAmB;AAAA,MACnB,aAAa;AAAA,MACb,YAAY;AAAA,MACZ,KAAK;AAAA,MACL,QAAQ;AAAA,MACR,KAAK;AAAA,MACL,WAAW;AAAA,MACX,cAAc;AAAA,MACd,cAAc;AAAA,IACf;AAAA,IACA,MAAM,WAAW,SAAS,OAAO,UAAoB;AAAA,IACrD,GAAG,UAAU,GAAG,mBAAmB,SAAS,SAAS,GAAG,QAAQ;AAAA,IAChE,GAAG,UAAU,GAAG,mBAAmB,SAAS,SAAS,GAAG,OAAO,SAAS,CAAG;AAAA,IAC3E,GAAG,UAAU,GAAG,mBAAmB,SAAS,aAAa,GAAG,OAAO,aAAa,GAAG;AAAA,IACnF,GAAG,UAAU,GAAG,mBAAmB,SAAS,cAAc,GAAG,WAAW,IAAI,WAAW,EAAE;AAAA;AAE3F;;;ACtRO,IAAM,YAAoB;AAAA,EAChC,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,WAAW;AAAA,IACX,OAAO;AAAA,IACP,WAAW;AAAA,IACX,OAAO;AAAA,EACR;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA2BhB,WAAW,CAAC,IAAI,SAAS,QAAQ,MAAM,YAAY;AAAA,IAClD,GAAG,UAAU,GAAG,mBAAmB,SAAS,aAAa,GAAG,OAAO,aAAa,GAAG;AAAA,IACnF,GAAG,UAAU,GAAG,mBAAmB,SAAS,SAAS,GAAG,OAAO,SAAS,GAAG;AAAA,IAC3E,GAAG,UAAU,GAAG,mBAAmB,SAAS,aAAa,GAAG,OAAO,aAAa,GAAG;AAAA,IACnF,GAAG,UAAU,GAAG,mBAAmB,SAAS,SAAS,IAAI,OAAO,SAAS,KAAK,OAAO,GAAG;AAAA,IACxF,GAAG,UAAU,GAAG,mBAAmB,SAAS,cAAc,GAAG,WAAW,IAAI,WAAW,EAAE;AAAA;AAE3F;;;AC5CO,IAAM,WAAmB;AAAA,EAC/B,MAAM;AAAA,EAEN,eAAe;AAAA,IACd,UAAU;AAAA,IACV,QAAQ;AAAA,EACT;AAAA,EAEA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBhB,WAAW,CAAC,IAAI,SAAS,QAAQ;AAAA,IAChC,GAAG,UAAU,GAAG,mBAAmB,SAAS,YAAY,GAAG,OAAO,YAAY,GAAG;AAAA,IACjF,GAAG,UAAU,GAAG,mBAAmB,SAAS,UAAU,GAAG,OAAO,UAAU,GAAG;AAAA;AAE/E;;;ACvBO,IAAM,aAAuB;AAAA,EACnC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD;;;ACrBO,IAAM,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUtB,IAAM,uBAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAU7B,SAAS,aAAa,CAC5B,IACA,MACA,QACc;AAAA,EACd,MAAM,SAAS,GAAG,aAAa,IAAI;AAAA,EACnC,IAAI,CAAC;AAAA,IAAQ,MAAM,IAAI,MAAM,yBAAyB;AAAA,EACtD,GAAG,aAAa,QAAQ,MAAM;AAAA,EAC9B,GAAG,cAAc,MAAM;AAAA,EACvB,IAAI,CAAC,GAAG,mBAAmB,QAAQ,GAAG,cAAc,GAAG;AAAA,IACtD,MAAM,OAAO,GAAG,iBAAiB,MAAM;AAAA,IACvC,GAAG,aAAa,MAAM;AAAA,IACtB,MAAM,IAAI,MAAM,yBAAyB;AAAA;AAAA,EAAkB,QAAQ;AAAA,EACpE;AAAA,EACA,OAAO;AAAA;AAID,SAAS,aAAa,CAC5B,IACA,cACA,gBACe;AAAA,EACf,MAAM,KAAK,cAAc,IAAI,GAAG,eAAe,YAAY;AAAA,EAC3D,MAAM,KAAK,cAAc,IAAI,GAAG,iBAAiB,cAAc;AAAA,EAC/D,MAAM,UAAU,GAAG,cAAc;AAAA,EACjC,IAAI,CAAC;AAAA,IAAS,MAAM,IAAI,MAAM,0BAA0B;AAAA,EACxD,GAAG,aAAa,SAAS,EAAE;AAAA,EAC3B,GAAG,aAAa,SAAS,EAAE;AAAA,EAC3B,GAAG,YAAY,OAAO;AAAA,EACtB,IAAI,CAAC,GAAG,oBAAoB,SAAS,GAAG,WAAW,GAAG;AAAA,IACrD,MAAM,OAAO,GAAG,kBAAkB,OAAO;AAAA,IACzC,GAAG,cAAc,OAAO;AAAA,IACxB,MAAM,IAAI,MAAM,uBAAuB,MAAM;AAAA,EAC9C;AAAA,EAEA,GAAG,aAAa,EAAE;AAAA,EAClB,GAAG,aAAa,EAAE;AAAA,EAClB,OAAO;AAAA;;;ACxDD,MAAM,SAAS;AAAA,EACb;AAAA,EACA,OAA0B,CAAC;AAAA,EAC3B,SAAyB,CAAC;AAAA,EAC1B,aAAiC;AAAA,EACjC,QAAQ;AAAA,EACR,SAAS;AAAA,EAEjB,WAAW,CAAC,IAA2B;AAAA,IACtC,KAAK,KAAK;AAAA,IACV,KAAK,UAAU;AAAA;AAAA,EAGR,SAAS,GAAS;AAAA,IACzB,MAAM,KAAK,KAAK;AAAA,IAChB,KAAK,aAAa,GAAG,aAAa;AAAA,IAClC,GAAG,WAAW,GAAG,cAAc,KAAK,UAAU;AAAA,IAE9C,GAAG,WACF,GAAG,cACH,IAAI,aAAa,CAAC,IAAI,IAAI,GAAG,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC,GAC3D,GAAG,WACJ;AAAA;AAAA,EAGO,SAAS,CAAC,OAAe,QAAiC;AAAA,IACjE,MAAM,KAAK,KAAK;AAAA,IAChB,MAAM,UAAU,GAAG,cAAc;AAAA,IACjC,GAAG,YAAY,GAAG,YAAY,OAAO;AAAA,IACrC,GAAG,WAAW,GAAG,YAAY,GAAG,GAAG,MAAM,OAAO,QAAQ,GAAG,GAAG,MAAM,GAAG,eAAe,IAAI;AAAA,IAC1F,GAAG,cAAc,GAAG,YAAY,GAAG,oBAAoB,GAAG,MAAM;AAAA,IAChE,GAAG,cAAc,GAAG,YAAY,GAAG,oBAAoB,GAAG,MAAM;AAAA,IAChE,GAAG,cAAc,GAAG,YAAY,GAAG,gBAAgB,GAAG,aAAa;AAAA,IACnE,GAAG,cAAc,GAAG,YAAY,GAAG,gBAAgB,GAAG,aAAa;AAAA,IAEnE,MAAM,cAAc,GAAG,kBAAkB;AAAA,IACzC,GAAG,gBAAgB,GAAG,aAAa,WAAW;AAAA,IAC9C,GAAG,qBAAqB,GAAG,aAAa,GAAG,mBAAmB,GAAG,YAAY,SAAS,CAAC;AAAA,IAEvF,GAAG,gBAAgB,GAAG,aAAa,IAAI;AAAA,IACvC,GAAG,YAAY,GAAG,YAAY,IAAI;AAAA,IAElC,OAAO,EAAE,aAAa,QAAQ;AAAA;AAAA,EAI/B,MAAM,CAAC,OAAe,QAAsB;AAAA,IAC3C,IAAI,KAAK,UAAU,SAAS,KAAK,WAAW;AAAA,MAAQ;AAAA,IACpD,KAAK,QAAQ;AAAA,IACb,KAAK,SAAS;AAAA,IACd,KAAK,YAAY;AAAA,IAGjB,SAAS,IAAI,EAAG,IAAI,GAAG,KAAK;AAAA,MAC3B,KAAK,KAAK,KAAK,KAAK,UAAU,OAAO,MAAM,CAAC;AAAA,IAC7C;AAAA;AAAA,EAGO,WAAW,GAAS;AAAA,IAC3B,MAAM,KAAK,KAAK;AAAA,IAChB,WAAW,OAAO,KAAK,MAAM;AAAA,MAC5B,GAAG,kBAAkB,IAAI,WAAW;AAAA,MACpC,GAAG,cAAc,IAAI,OAAO;AAAA,IAC7B;AAAA,IACA,KAAK,OAAO,CAAC;AAAA;AAAA,EAId,WAAW,CAAC,SAAyB;AAAA,IACpC,MAAM,KAAK,KAAK;AAAA,IAEhB,WAAW,KAAK,KAAK,QAAQ;AAAA,MAC5B,GAAG,cAAc,EAAE,OAAO;AAAA,IAC3B;AAAA,IACA,KAAK,SAAS,CAAC;AAAA,IAEf,WAAW,UAAU,SAAS;AAAA,MAC7B,IAAI,YAAY,MAAM,GAAG;AAAA,QACxB,SAAS,IAAI,EAAG,IAAI,OAAO,QAAQ,KAAK;AAAA,UACvC,MAAM,OAAO,OAAO,kBAAkB,CAAC;AAAA,UACvC,MAAM,UAAU,cAAc,IAAI,eAAe,IAAI;AAAA,UACrD,KAAK,OAAO,KAAK,EAAE,SAAS,QAAQ,WAAW,EAAE,CAAC;AAAA,QACnD;AAAA,MACD,EAAO;AAAA,QACN,MAAM,UAAU,cAAc,IAAI,eAAe,OAAO,cAAc;AAAA,QACtE,KAAK,OAAO,KAAK,EAAE,SAAS,QAAQ,WAAW,EAAE,CAAC;AAAA;AAAA,IAEpD;AAAA;AAAA,EAID,MAAM,CACL,eACA,QACA,MACO;AAAA,IACP,MAAM,KAAK,KAAK;AAAA,IAChB,IAAI,KAAK,OAAO,WAAW,KAAK,KAAK,KAAK,SAAS;AAAA,MAAG;AAAA,IAEtD,MAAM,aAA+B,CAAC,KAAK,OAAO,KAAK,MAAM;AAAA,IAC7D,IAAI,eAAe;AAAA,IACnB,IAAI,WAAW;AAAA,IAEf,SAAS,IAAI,EAAG,IAAI,KAAK,OAAO,QAAQ,KAAK;AAAA,MAC5C,MAAM,OAAO,KAAK,OAAO;AAAA,MACzB,MAAM,SAAS,MAAM,KAAK,OAAO,SAAS;AAAA,MAC1C,MAAM,eAAe,OAAO,KAAK,OAAO,SAAS,KAAK,OAAO;AAAA,MAE7D,IAAI,QAAQ;AAAA,QAEX,GAAG,gBAAgB,GAAG,aAAa,IAAI;AAAA,QACvC,GAAG,SAAS,GAAG,GAAG,GAAG,oBAAoB,GAAG,mBAAmB;AAAA,MAChE,EAAO;AAAA,QAEN,MAAM,SAAS,KAAK,KAAK;AAAA,QACzB,GAAG,gBAAgB,GAAG,aAAa,OAAO,WAAW;AAAA,QACrD,GAAG,SAAS,GAAG,GAAG,KAAK,OAAO,KAAK,MAAM;AAAA;AAAA,MAG1C,GAAG,WAAW,KAAK,OAAO;AAAA,MAG1B,GAAG,cAAc,GAAG,QAAQ;AAAA,MAC5B,GAAG,YAAY,GAAG,YAAY,YAAY;AAAA,MAC1C,MAAM,SAAS,GAAG,mBAAmB,KAAK,SAAS,WAAW;AAAA,MAC9D,GAAG,UAAU,QAAQ,CAAC;AAAA,MAGtB,IAAI,YAAY,KAAK,MAAM,GAAG;AAAA,QAC7B,KAAK,OAAO,gBACX,IACA,KAAK,SACL,cACA,MACA,YACA,KAAK,SACN;AAAA,MACD,EAAO;AAAA,QACN,KAAK,OAAO,YAAY,IAAI,KAAK,SAAS,cAAc,MAAM,UAAU;AAAA;AAAA,MAIzE,GAAG,WAAW,GAAG,cAAc,KAAK,UAAU;AAAA,MAC9C,MAAM,SAAS,GAAG,kBAAkB,KAAK,SAAS,YAAY;AAAA,MAC9D,GAAG,wBAAwB,MAAM;AAAA,MACjC,GAAG,oBAAoB,QAAQ,GAAG,GAAG,OAAO,OAAO,GAAG,CAAC;AAAA,MACvD,GAAG,WAAW,GAAG,WAAW,GAAG,CAAC;AAAA,MAEhC,IAAI,CAAC,QAAQ;AAAA,QACZ,eAAe,KAAK,KAAK,UAAU;AAAA,QACnC,YAAY,WAAW,KAAK,KAAK,KAAK;AAAA,MACvC;AAAA,IACD;AAAA;AAAA,EAID,iBAAiB,CAAC,eAA6B,oBAAwC;AAAA,IACtF,MAAM,KAAK,KAAK;AAAA,IAChB,GAAG,gBAAgB,GAAG,aAAa,IAAI;AAAA,IACvC,GAAG,SAAS,GAAG,GAAG,GAAG,oBAAoB,GAAG,mBAAmB;AAAA,IAC/D,GAAG,WAAW,kBAAkB;AAAA,IAChC,GAAG,cAAc,GAAG,QAAQ;AAAA,IAC5B,GAAG,YAAY,GAAG,YAAY,aAAa;AAAA,IAC3C,GAAG,UAAU,GAAG,mBAAmB,oBAAoB,WAAW,GAAG,CAAC;AAAA,IACtE,GAAG,WAAW,GAAG,cAAc,KAAK,UAAU;AAAA,IAC9C,MAAM,SAAS,GAAG,kBAAkB,oBAAoB,YAAY;AAAA,IACpE,GAAG,wBAAwB,MAAM;AAAA,IACjC,GAAG,oBAAoB,QAAQ,GAAG,GAAG,OAAO,OAAO,GAAG,CAAC;AAAA,IACvD,GAAG,WAAW,GAAG,WAAW,GAAG,CAAC;AAAA;AAAA,EAGjC,OAAO,GAAS;AAAA,IACf,MAAM,KAAK,KAAK;AAAA,IAChB,KAAK,YAAY;AAAA,IACjB,WAAW,KAAK,KAAK,QAAQ;AAAA,MAC5B,GAAG,cAAc,EAAE,OAAO;AAAA,IAC3B;AAAA,IACA,KAAK,SAAS,CAAC;AAAA,IACf,IAAI,KAAK,YAAY;AAAA,MACpB,GAAG,aAAa,KAAK,UAAU;AAAA,MAC/B,KAAK,aAAa;AAAA,IACnB;AAAA;AAEF;AAEA,SAAS,WAAW,CAAC,QAA2C;AAAA,EAC/D,OAAO,YAAY,UAAU,OAAQ,OAAe,WAAW;AAAA;;;ACxLzD,MAAM,SAAS;AAAA,EACd;AAAA,EACA;AAAA,EACC;AAAA,EACA,gBAAqC;AAAA,EACrC;AAAA,EACA,cAA6B;AAAA,EAC7B,YAAY;AAAA,EACZ,SAA8C,CAAC;AAAA,EAC/C,gBAA0B,CAAC;AAAA,EAC3B,aAAa;AAAA,EACb,cAAc;AAAA,EACd,cAAc;AAAA,EACd;AAAA,EACA;AAAA,EACA,iBAAwC;AAAA,EAEhD,WAAW,CAAC,QAA2B,UAAsB,CAAC,GAAG;AAAA,IAChE,KAAK,SAAS;AAAA,IACd,MAAM,KAAK,OAAO,WAAW,SAAS;AAAA,MACrC,OAAO;AAAA,MACP,oBAAoB;AAAA,MACpB,uBAAuB;AAAA,MACvB,WAAW;AAAA,IACZ,CAAC;AAAA,IACD,IAAI,CAAC;AAAA,MAAI,MAAM,IAAI,MAAM,qBAAqB;AAAA,IAC9C,KAAK,KAAK;AAAA,IAEV,KAAK,WAAW,IAAI,SAAS,EAAE;AAAA,IAC/B,KAAK,qBAAqB,cAAc,IAAI,eAAe,oBAAoB;AAAA,IAG/E,KAAK,WAAW,OAAO;AAAA,IAGvB,KAAK,gBAAgB,CAAC,MAAa;AAAA,MAClC,EAAE,eAAe;AAAA,MACjB,KAAK,cAAc;AAAA,MACnB,IAAI,KAAK,gBAAgB,MAAM;AAAA,QAC9B,qBAAqB,KAAK,WAAW;AAAA,QACrC,KAAK,cAAc;AAAA,MACpB;AAAA;AAAA,IAED,KAAK,oBAAoB,MAAM;AAAA,MAC9B,KAAK,cAAc;AAAA,MACnB,KAAK,WAAW;AAAA;AAAA,IAEjB,OAAO,iBAAiB,oBAAoB,KAAK,aAAa;AAAA,IAC9D,OAAO,iBAAiB,wBAAwB,KAAK,iBAAiB;AAAA,IAGtE,KAAK,iBAAiB,IAAI,eAAe,MAAM,KAAK,aAAa,CAAC;AAAA,IAClE,KAAK,eAAe,QAAQ,MAAM;AAAA;AAAA,EAG3B,YAAY,GAAS;AAAA,IAC5B,MAAM,MAAM,OAAO,oBAAoB;AAAA,IACvC,MAAM,OAAO,KAAK,OAAO,sBAAsB;AAAA,IAC/C,MAAM,IAAI,KAAK,MAAM,KAAK,QAAQ,GAAG;AAAA,IACrC,MAAM,IAAI,KAAK,MAAM,KAAK,SAAS,GAAG;AAAA,IACtC,IAAI,KAAK,OAAO,UAAU,KAAK,KAAK,OAAO,WAAW,GAAG;AAAA,MACxD,KAAK,OAAO,QAAQ;AAAA,MACpB,KAAK,OAAO,SAAS;AAAA,MACrB,IAAI,KAAK,aAAa,GAAG;AAAA,QACxB,KAAK,SAAS,OAAO,KAAK,YAAY,KAAK,WAAW;AAAA,MACvD;AAAA,IACD;AAAA;AAAA,EAGD,UAAU,CAAC,SAA2B;AAAA,IAErC,MAAM,YAAoC,CAAC;AAAA,IAC3C,WAAW,KAAK,YAAY;AAAA,MAC3B,UAAU,EAAE,QAAQ;AAAA,IACrB;AAAA,IAEA,KAAK,SAAS,CAAC;AAAA,IACf,KAAK,gBAAgB,CAAC;AAAA,IAGtB,MAAM,cAAc;AAAA,MACnB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,IAEA,WAAW,QAAQ,aAAa;AAAA,MAC/B,MAAM,OAAQ,QAAgB;AAAA,MAC9B,IAAI,SAAS;AAAA,QAAW;AAAA,MACxB,IAAI,KAAK,YAAY;AAAA,QAAO;AAAA,MAE5B,MAAM,SAAS,UAAU;AAAA,MACzB,IAAI,CAAC;AAAA,QAAQ;AAAA,MAEb,KAAK,OAAO,QAAQ,KAAK,OAAO,kBAAkB,KAAK;AAAA,MACvD,KAAK,cAAc,KAAK,MAAM;AAAA,IAC/B;AAAA,IAGA,IAAI,CAAC,KAAK,aAAa;AAAA,MACtB,KAAK,SAAS,YAAY,KAAK,aAAa;AAAA,IAC7C;AAAA;AAAA,EAGD,YAAY,CAAC,SAA2B;AAAA,IAEvC,YAAY,KAAK,QAAQ,OAAO,QAAQ,OAAO,GAAG;AAAA,MACjD,IAAI,QAAQ;AAAA,QAAW;AAAA,MACvB,IAAI,OAAO,QAAQ,YAAY,QAAQ,MAAM;AAAA,QAC5C,IAAK,IAAY,YAAY,OAAO;AAAA,UAEnC,OAAO,KAAK,OAAO;AAAA,UACnB,KAAK,gBAAgB,KAAK,cAAc,OAAO,CAAC,MAAM,EAAE,SAAS,GAAG;AAAA,QACrE,EAAO,SAAI,KAAK,OAAO,MAAM;AAAA,UAE5B,OAAO,OAAO,KAAK,OAAO,MAAM,GAAG;AAAA,QACpC,EAAO;AAAA,UAEN,MAAM,YAAoC,CAAC;AAAA,UAC3C,WAAW,KAAK;AAAA,YAAY,UAAU,EAAE,QAAQ;AAAA,UAChD,MAAM,SAAS,UAAU;AAAA,UACzB,IAAI,QAAQ;AAAA,YACX,KAAK,OAAO,OAAO,KAAK,OAAO,kBAAmB,IAAY;AAAA,YAC9D,KAAK,cAAc,KAAK,MAAM;AAAA,UAC/B;AAAA;AAAA,MAEF;AAAA,IACD;AAAA,IACA,IAAI,CAAC,KAAK,aAAa;AAAA,MACtB,KAAK,SAAS,YAAY,KAAK,aAAa;AAAA,IAC7C;AAAA;AAAA,OAGK,UAAS,CAAC,QAAoC;AAAA,IACnD,MAAM,KAAK,KAAK;AAAA,IAChB,IAAI;AAAA,IAEJ,IAAI,OAAO,WAAW,UAAU;AAAA,MAC/B,MAAM,MAAM,iBAAiB,MAAM;AAAA,IACpC,EAAO,SAAI,kBAAkB,QAAQ,kBAAkB,MAAM;AAAA,MAC5D,MAAM,MAAM,IAAI,gBAAgB,MAAM;AAAA,MACtC,IAAI;AAAA,QACH,MAAM,MAAM,iBAAiB,GAAG;AAAA,gBAC/B;AAAA,QACD,IAAI,gBAAgB,GAAG;AAAA;AAAA,IAEzB,EAAO,SAAI,kBAAkB,WAAW;AAAA,MAEvC,MAAM,IAAI,SAAS,cAAc,QAAQ;AAAA,MACzC,EAAE,QAAQ,OAAO;AAAA,MACjB,EAAE,SAAS,OAAO;AAAA,MAClB,MAAM,MAAM,EAAE,WAAW,IAAI;AAAA,MAC7B,IAAI,aAAa,QAAQ,GAAG,CAAC;AAAA,MAC7B,MAAM;AAAA,IACP,EAAO;AAAA,MACN,MAAM;AAAA;AAAA,IAIP,IAAI,eAAe,kBAAkB;AAAA,MACpC,KAAK,aAAa,IAAI;AAAA,MACtB,KAAK,cAAc,IAAI;AAAA,IACxB,EAAO,SAAI,eAAe,mBAAmB;AAAA,MAC5C,KAAK,aAAa,IAAI;AAAA,MACtB,KAAK,cAAc,IAAI;AAAA,IACxB,EAAO,SAAI,eAAe,aAAa;AAAA,MACtC,KAAK,aAAa,IAAI;AAAA,MACtB,KAAK,cAAc,IAAI;AAAA,IACxB,EAAO;AAAA,MACN,KAAK,aAAc,IAAY,SAAS,KAAK,OAAO;AAAA,MACpD,KAAK,cAAe,IAAY,UAAU,KAAK,OAAO;AAAA;AAAA,IAIvD,IAAI,KAAK,eAAe;AAAA,MACvB,GAAG,cAAc,KAAK,aAAa;AAAA,IACpC;AAAA,IACA,KAAK,gBAAgB,GAAG,cAAc;AAAA,IACtC,GAAG,YAAY,GAAG,YAAY,KAAK,aAAa;AAAA,IAChD,GAAG,YAAY,GAAG,qBAAqB,CAAC;AAAA,IACxC,GAAG,WAAW,GAAG,YAAY,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,eAAe,GAAG;AAAA,IACvE,GAAG,cAAc,GAAG,YAAY,GAAG,oBAAoB,GAAG,MAAM;AAAA,IAChE,GAAG,cAAc,GAAG,YAAY,GAAG,oBAAoB,GAAG,MAAM;AAAA,IAChE,GAAG,cAAc,GAAG,YAAY,GAAG,gBAAgB,GAAG,aAAa;AAAA,IACnE,GAAG,cAAc,GAAG,YAAY,GAAG,gBAAgB,GAAG,aAAa;AAAA,IACnE,GAAG,YAAY,GAAG,YAAY,IAAI;AAAA,IAElC,KAAK,SAAS,OAAO,KAAK,YAAY,KAAK,WAAW;AAAA,IACtD,KAAK,YAAY,CAAC;AAAA;AAAA,EAGX,WAAW,CAAC,MAAoB;AAAA,IACvC,IAAI,KAAK,eAAe,CAAC,KAAK;AAAA,MAAe;AAAA,IAC7C,MAAM,KAAK,KAAK;AAAA,IAEhB,GAAG,WAAW,GAAG,GAAG,GAAG,CAAC;AAAA,IACxB,GAAG,MAAM,GAAG,gBAAgB;AAAA,IAE5B,IAAI,KAAK,cAAc,WAAW,GAAG;AAAA,MACpC,KAAK,SAAS,kBAAkB,KAAK,eAAe,KAAK,kBAAkB;AAAA,IAC5E,EAAO;AAAA,MACN,KAAK,SAAS,OAAO,KAAK,eAAe,KAAK,QAAQ,IAAI;AAAA;AAAA;AAAA,EAI5D,KAAK,GAAS;AAAA,IACb,IAAI,KAAK,gBAAgB;AAAA,MAAM;AAAA,IAC/B,KAAK,YAAY,YAAY,IAAI;AAAA,IACjC,MAAM,OAAO,CAAC,QAAgB;AAAA,MAC7B,MAAM,KAAK,MAAM,KAAK,aAAa;AAAA,MACnC,KAAK,YAAY,CAAC;AAAA,MAClB,KAAK,cAAc,sBAAsB,IAAI;AAAA;AAAA,IAE9C,KAAK,cAAc,sBAAsB,IAAI;AAAA;AAAA,EAG9C,IAAI,GAAS;AAAA,IACZ,IAAI,KAAK,gBAAgB,MAAM;AAAA,MAC9B,qBAAqB,KAAK,WAAW;AAAA,MACrC,KAAK,cAAc;AAAA,IACpB;AAAA;AAAA,EAID,UAAU,GAAS;AAAA,IAClB,KAAK,YAAY,YAAY,IAAI,IAAI,IAAI;AAAA;AAAA,EAGlC,UAAU,GAAS;AAAA,IAC1B,KAAK,qBAAqB,cAAc,KAAK,IAAI,eAAe,oBAAoB;AAAA,IACpF,KAAK,WAAW,IAAI,SAAS,KAAK,EAAE;AAAA,IACpC,IAAI,KAAK,aAAa,GAAG;AAAA,MACxB,KAAK,SAAS,OAAO,KAAK,YAAY,KAAK,WAAW;AAAA,IACvD;AAAA,IACA,KAAK,SAAS,YAAY,KAAK,aAAa;AAAA;AAAA,EAG7C,OAAO,GAAS;AAAA,IACf,KAAK,KAAK;AAAA,IACV,KAAK,OAAO,oBAAoB,oBAAoB,KAAK,aAAa;AAAA,IACtE,KAAK,OAAO,oBAAoB,wBAAwB,KAAK,iBAAiB;AAAA,IAC9E,IAAI,KAAK,gBAAgB;AAAA,MACxB,KAAK,eAAe,WAAW;AAAA,MAC/B,KAAK,iBAAiB;AAAA,IACvB;AAAA,IACA,MAAM,KAAK,KAAK;AAAA,IAChB,KAAK,SAAS,QAAQ;AAAA,IACtB,IAAI,KAAK,eAAe;AAAA,MACvB,GAAG,cAAc,KAAK,aAAa;AAAA,MACnC,KAAK,gBAAgB;AAAA,IACtB;AAAA,IACA,GAAG,cAAc,KAAK,kBAAkB;AAAA;AAE1C;AAEA,SAAS,gBAAgB,CAAC,KAAwC;AAAA,EACjE,OAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAAA,IACvC,MAAM,MAAM,IAAI;AAAA,IAChB,IAAI,cAAc;AAAA,IAClB,IAAI,SAAS,MAAM,QAAQ,GAAG;AAAA,IAC9B,IAAI,UAAU,MAAM,OAAO,IAAI,MAAM,yBAAyB,KAAK,CAAC;AAAA,IACpE,IAAI,MAAM;AAAA,GACV;AAAA;;;AC9QK,SAAS,aAAa,CAC5B,QACA,WAAW,aACX,SACS;AAAA,EACT,OAAO,OAAO,UAAU,UAAU,OAAO;AAAA;AAGnC,SAAS,UAAU,CACzB,QACA,WAAW,aACX,SACgB;AAAA,EAChB,OAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAAA,IACvC,OAAO,OACN,CAAC,SAAS;AAAA,MACT,IAAI;AAAA,QAAM,QAAQ,IAAI;AAAA,MACjB;AAAA,eAAO,IAAI,MAAM,iCAAiC,CAAC;AAAA,OAEzD,UACA,OACD;AAAA,GACA;AAAA;AAGK,SAAS,cAAc,CAC7B,cACA,cACoB;AAAA,EACpB,MAAM,SAAS,gBAAgB,SAAS,cAAc,QAAQ;AAAA,EAC9D,OAAO,QAAQ,aAAa;AAAA,EAC5B,OAAO,SAAS,aAAa;AAAA,EAC7B,MAAM,MAAM,OAAO,WAAW,IAAI;AAAA,EAClC,IAAI,UAAU,cAAc,GAAG,CAAC;AAAA,EAChC,OAAO;AAAA;;;AClCD,IAAM,UAAsC;AAAA,EAClD,WAAW;AAAA,IACV,UAAU,EAAE,OAAO,mBAAmB,OAAO,GAAK,WAAW,IAAI;AAAA,IACjE,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,OAAO,EAAE,QAAQ,GAAG,UAAU,KAAK,WAAW,IAAI;AAAA,IAClD,WAAW,EAAE,QAAQ,EAAI;AAAA,IACzB,UAAU,EAAE,UAAU,MAAM,QAAQ,KAAK;AAAA,IACzC,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,OAAO,EAAE,WAAW,MAAM,kBAAkB,KAAK;AAAA,EAClD;AAAA,EAEA,QAAQ;AAAA,IACP,UAAU,EAAE,OAAO,UAAU,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,OAAO,EAAE,QAAQ,GAAG,UAAU,KAAK,WAAW,IAAI;AAAA,IAClD,WAAW,EAAE,QAAQ,EAAI;AAAA,IACzB,UAAU,EAAE,UAAU,KAAK,QAAQ,IAAI;AAAA,IACvC,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,OAAO,EAAE,WAAW,MAAM,kBAAkB,KAAK;AAAA,EAClD;AAAA,EAEA,KAAK;AAAA,IACJ,UAAU,EAAE,OAAO,OAAO,OAAO,KAAK,WAAW,IAAI;AAAA,IACrD,WAAW,EAAE,WAAW,MAAM,OAAO,MAAM,WAAW,IAAI;AAAA,IAC1D,OAAO,EAAE,QAAQ,GAAG,UAAU,MAAM,WAAW,KAAK;AAAA,IACpD,WAAW,EAAE,QAAQ,IAAI;AAAA,IACzB,UAAU,EAAE,UAAU,KAAK,QAAQ,IAAI;AAAA,IACvC,OAAO,EAAE,WAAW,OAAO,kBAAkB,MAAM;AAAA,EACpD;AAAA,EAEA,KAAK;AAAA,IACJ,UAAU,EAAE,OAAO,aAAa,OAAO,KAAK,WAAW,IAAI;AAAA,IAC3D,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,YAAY,EAAE,QAAQ,MAAM,WAAW,EAAE;AAAA,IACzC,WAAW,EAAE,QAAQ,EAAI;AAAA,IACzB,OAAO,EAAE,WAAW,MAAM,kBAAkB,MAAM,OAAO,EAAI;AAAA,IAC7D,UAAU,EAAE,UAAU,KAAK,QAAQ,KAAK;AAAA,EACzC;AAAA,EAEA,UAAU;AAAA,IACT,UAAU,EAAE,OAAO,cAAc,OAAO,GAAK,WAAW,IAAI;AAAA,IAC5D,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,OAAO,EAAE,QAAQ,GAAG,UAAU,KAAK,WAAW,IAAI;AAAA,IAClD,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,UAAU,EAAE,UAAU,KAAK,QAAQ,IAAI;AAAA,IACvC,OAAO,EAAE,WAAW,MAAM,kBAAkB,KAAK;AAAA,EAClD;AAAA,EAEA,eAAe;AAAA,IACd,UAAU,EAAE,OAAO,cAAc,OAAO,GAAK,WAAW,IAAI;AAAA,IAC5D,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,OAAO,EAAE,QAAQ,GAAG,UAAU,KAAK,WAAW,IAAI;AAAA,IAClD,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,UAAU,EAAE,UAAU,KAAK,QAAQ,IAAI;AAAA,IACvC,OAAO,EAAE,WAAW,MAAM,kBAAkB,KAAK;AAAA,EAClD;AAAA,EAEA,aAAa;AAAA,IACZ,UAAU,EAAE,OAAO,aAAa,OAAO,KAAK,WAAW,IAAI;AAAA,IAC3D,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,UAAU,EAAE,UAAU,KAAK,QAAQ,KAAK;AAAA,IACxC,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,OAAO,EAAE,WAAW,MAAM,kBAAkB,KAAK;AAAA,IACjD,WAAW,EAAE,QAAQ,EAAI;AAAA,IACzB,YAAY,EAAE,QAAQ,MAAM;AAAA,EAC7B;AAAA,EAEA,WAAW;AAAA,IACV,UAAU,EAAE,OAAO,OAAO,OAAO,GAAK,WAAW,KAAK;AAAA,IACtD,WAAW,EAAE,WAAW,KAAK,OAAO,MAAM,WAAW,IAAI;AAAA,IACzD,OAAO,EAAE,QAAQ,GAAG,UAAU,KAAK,WAAW,IAAI;AAAA,IAClD,UAAU,EAAE,UAAU,KAAK,QAAQ,IAAI;AAAA,IACvC,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,OAAO,EAAE,WAAW,MAAM,kBAAkB,MAAM;AAAA,EACnD;AAAA,EAEA,aAAa;AAAA,IACZ,UAAU,EAAE,OAAO,eAAe,OAAO,KAAK,WAAW,IAAI;AAAA,IAC7D,WAAW,EAAE,WAAW,KAAK,OAAO,KAAK,WAAW,IAAI;AAAA,IACxD,OAAO,EAAE,QAAQ,GAAG,UAAU,MAAM,WAAW,IAAI;AAAA,IACnD,WAAW,EAAE,QAAQ,IAAI;AAAA,IACzB,UAAU,EAAE,UAAU,MAAM,QAAQ,IAAI;AAAA,IACxC,WAAW,EAAE,QAAQ,KAAK;AAAA,IAC1B,OAAO,EAAE,WAAW,MAAM,kBAAkB,KAAK;AAAA,EAClD;AAAA,EAEA,WAAW;AAAA,IACV,UAAU,EAAE,OAAO,mBAAmB,OAAO,KAAK,WAAW,KAAK;AAAA,IAClE,WAAW,EAAE,WAAW,MAAM,OAAO,MAAM,WAAW,IAAI;AAAA,IAC1D,OAAO,EAAE,QAAQ,GAAG,UAAU,KAAK,WAAW,IAAI;AAAA,IAClD,UAAU,EAAE,UAAU,KAAK,QAAQ,IAAI;AAAA,IACvC,WAAW,EAAE,QAAQ,MAAM;AAAA,IAC3B,WAAW,EAAE,QAAQ,IAAI;AAAA,IACzB,OAAO,EAAE,WAAW,OAAO,kBAAkB,KAAK;AAAA,EACnD;AACD;;;AC7FO,MAAM,UAAU;AAAA,EACd;AAAA,EAER,WAAW,CAAC,QAA2B,UAAsB,CAAC,GAAG;AAAA,IAChE,KAAK,WAAW,IAAI,SAAS,QAAQ,OAAO;AAAA;AAAA,OAIvC,UAAS,CAAC,QAAoC;AAAA,IACnD,OAAO,KAAK,SAAS,UAAU,MAAM;AAAA;AAAA,EAItC,KAAK,GAAS;AAAA,IACb,KAAK,SAAS,MAAM;AAAA;AAAA,EAIrB,IAAI,GAAS;AAAA,IACZ,KAAK,SAAS,KAAK;AAAA;AAAA,EAIpB,UAAU,GAAS;AAAA,IAClB,KAAK,SAAS,WAAW;AAAA;AAAA,EAI1B,MAAM,CAAC,SAA2B;AAAA,IACjC,KAAK,SAAS,aAAa,OAAO;AAAA,IAClC,KAAK,SAAS,WAAW;AAAA;AAAA,EAI1B,UAAU,CAAC,SAA2B;AAAA,IACrC,KAAK,SAAS,WAAW,OAAO;AAAA,IAChC,KAAK,SAAS,WAAW;AAAA;AAAA,OAIpB,WAAU,CAAC,WAAW,aAAa,SAAiC;AAAA,IACzE,KAAK,SAAS,WAAW;AAAA,IACzB,OAAO,WAAW,KAAK,SAAS,QAAQ,UAAU,OAAO;AAAA;AAAA,EAI1D,aAAa,CAAC,WAAW,aAAa,SAA0B;AAAA,IAC/D,KAAK,SAAS,WAAW;AAAA,IACzB,OAAO,cAAc,KAAK,SAAS,QAAQ,UAAU,OAAO;AAAA;AAAA,EAI7D,cAAc,CAAC,QAA+C;AAAA,IAC7D,KAAK,SAAS,WAAW;AAAA,IACzB,OAAO,eAAe,KAAK,SAAS,QAAQ,MAAM;AAAA;AAAA,MAI/C,MAAM,GAAsB;AAAA,IAC/B,OAAO,KAAK,SAAS;AAAA;AAAA,EAItB,OAAO,GAAS;AAAA,IACf,KAAK,SAAS,QAAQ;AAAA;AAExB;",
  "debugId": "597E2548DA975F2264756E2164756E21",
  "names": []
}